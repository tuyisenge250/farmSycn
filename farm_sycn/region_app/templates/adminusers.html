{% extends 'base_admin.html' %}
{% load static %}
{% block title %}All Users{% endblock %}
{% block content %}
<section class="table-section-user">
    <h2>Manage Users</h2>

    {% if form %}
    <section>
        <h3>Edit User</h3>
        <form method="post" action="">
            {% csrf_token %}
            {{ form.as_p }}
            <input type="hidden" name="save" value="{{ form.instance.id }}">  <!-- Hidden input for user ID -->
            <button type="submit">Save Changes</button>
        </form>
    </section>
    {% endif %}

    <!-- Users Table -->
    <table>
        <thead>
            <tr>
                <th>Full Name</th>
                <th>Abv Name</th>
                <th>Email</th>
                <th>Phone</th>
                <th>role</th>
                <th>Password</th>
                <th>Status</th>
                <th colspan="4">Action</th>
            </tr>
        </thead>
        <tbody>
            {% for user in users %}
            <tr>
                <td>{{ user.full_name }}</td>
                <td>{{ user.abv_name }}</td>
                <td>{{ user.email }}</td>
                <td>{{ user.phone }}</td>
                <td>{{ user.role }}</td>
                <td>*****</td>
                <td>{{ user.status }}</td>

                <td>
                    <form method="post" action="">
                        {% csrf_token %}
                        <button name="prove" value="{{ user.id }}" title="Approve/Disapprove">
                            <i class="fa-solid fa-square-check"></i>
                        </button>
                    </form>
                </td>
                <td>
                    <form method="post" action="">
                        {% csrf_token %}
                        <button name="edit" value="{{ user.id }}" title="Edit">
                            <i class="fa-solid fa-pen-to-square"></i>
                        </button>
                    </form>
                </td>

                <!-- Delete Button -->
                <td>
                    <form method="post" action="" onsubmit="return confirm('Are you sure you want to delete this user?');">
                        {% csrf_token %}
                        <button name="delete" value="{{ user.id }}" title="Delete">
                            <i class="fa-solid fa-trash"></i>
                        </button>
                    </form>
                </td>

                <!-- More Button -->
                <td>
                    <a href="{% url 'overviews' user.id %}" title="More">
                        <i class="fa-solid fa-ellipsis"></i>
                    </a>
                </td>
                <td>
                    <a href="{% url 'system' user.id %}"><button>
                        <i class="fa-solid fa-plus"></i>
                    </button></a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
</section>
{% endblock %}
